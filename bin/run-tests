#!/bin/bash
set -x

runRspec(){
  local case=${1:-""}
  bundle exec rspec -f progress -f JUnit -o spec/ruby-agent-junit${case}.xml ${case}
}
specific_spec=$1

if [[ $specific_spec = '' ]]; then
  echo 'Running all specs, including integration'

  runRspec
  find spec/integration -name '*_spec.rb' -exec runRspec {} \;
else
  echo "Running only $specific_spec"

  runRspec $1
fi
