#!/bin/bash
set -x

runBaseCase(){
  local case=${1:-""}
  bundle exec rspec -f progress -f JUnit -o spec/ruby-agent-junit${case}.xml ${case}
}
specific_spec=$1

if [[ $specific_spec = '' ]]; then
  echo 'Running all specs, including integration'

  runBaseCase
  find spec/integration -name '*_spec.rb' -exec runBaseCase {} \;
else
  echo "Running only $specific_spec"

  runBaseCase $1
fi
